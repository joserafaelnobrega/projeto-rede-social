CREATE TABLE TB_TAG_CHAT (
  TCH_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  TCH_NOME VARCHAR(30) NOT NULL,
  PRIMARY KEY(TCH_ID)
);

CREATE TABLE TB_SEXO (
  SEX_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  SEX_SIGLA CHAR(1) NOT NULL,
  PRIMARY KEY(SEX_ID)
);

CREATE TABLE TB_RANK (
  RAN_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  RAN_POSICAO INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(RAN_ID)
);

CREATE TABLE TB_TEMA_USUARIO (
  TEU_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  TEU_TEMA VARCHAR(30) NOT NULL,
  PRIMARY KEY(TEU_ID)
);

CREATE TABLE TB_TEMA_CHAT (
  TEC_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  TEC_AVALIACAO TINYINT UNSIGNED ZEROFILL NULL,
  TEC_RANKING  INTEGER UNSIGNED NOT NULL,
  TEC_DESCRICAO TEXT NOT NULL,
  PRIMARY KEY(TEC_ID)
);

CREATE TABLE TB_TAG_USUARIO (
  TAU_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  TAU_FAVORITO VARCHAR(30) NOT NULL,
  TAU_MENOS_FAVO VARCHAR(30) NOT NULL,
  TAU_NEGATIVA VARCHAR(30) NOT NULL,
  TAU_POSITIVA VARCHAR(30) NOT NULL,
  PRIMARY KEY(TAU_ID)
);

CREATE TABLE `tb_chat` (
  `CHA_ID` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `CHA_NOME` varchar(20) NOT NULL,
  `CHA_DESCRICAO` text,
  `CHA_TEXTO` text,
  PRIMARY KEY (`CHA_ID`)
) ENGINE=InnoDB AUTO_INCREMENT=48 DEFAULT CHARSET=latin1;

CREATE TABLE TB_CATEGORIA (
  CAT_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  CAT_NOME VARCHAR(40) NOT NULL,
  PRIMARY KEY(CAT_ID)
);

CREATE TABLE TB_PENALIDADE (
  PEN_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  PEN_TEMPO INTEGER UNSIGNED ZEROFILL NULL,
  PEN_NIVEL INTEGER UNSIGNED ZEROFILL NULL,
  PEN_CONTADOR INTEGER UNSIGNED ZEROFILL NULL,
  PEN_RESETE DATETIME NULL,
  PRIMARY KEY(PEN_ID)
);

CREATE TABLE TB_TAG (
  TAG_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  TAG_TCH_ID INTEGER UNSIGNED NOT NULL,
  TAG_TAU_ID INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(TAG_ID),
  INDEX FK_TAU_TAG(TAG_TAU_ID),
  INDEX FK_TCH_TAG(TAG_TCH_ID),
  FOREIGN KEY(TAG_TAU_ID)
    REFERENCES TB_TAG_USUARIO(TAU_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(TAG_TCH_ID)
    REFERENCES TB_TAG_CHAT(TCH_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

CREATE TABLE TB_TEMA (
  TEM_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  TEM_TEU_ID INTEGER UNSIGNED NOT NULL,
  TEM_TEC_ID INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(TEM_ID),
  INDEX FK_TEC_TEM(TEM_TEC_ID),
  INDEX FK_TEU_TEM(TEM_TEU_ID),
  FOREIGN KEY(TEM_TEC_ID)
    REFERENCES TB_TEMA_CHAT(TEC_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(TEM_TEU_ID)
    REFERENCES TB_TEMA_USUARIO(TEU_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

CREATE TABLE TB_USUARIO (
  USU_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  USU_RAN_ID INTEGER UNSIGNED NOT NULL,
  USU_CAT_ID INTEGER UNSIGNED NOT NULL,
  USU_PEN_ID INTEGER UNSIGNED NOT NULL,
  USU_SEX_ID INTEGER UNSIGNED NOT NULL,
  USU_LOGIN VARCHAR(40) NULL,
  USU_SENHA INTEGER UNSIGNED NOT NULL,
  USU_CICLO TINYINT UNSIGNED NOT NULL,
  USU_DESCRICAO TEXT NULL,
  USU_AVALIACAO TINYINT UNSIGNED ZEROFILL NOT NULL,
  USU_MEDALHAESTRELA TINYINT UNSIGNED ZEROFILL NULL,
  USU_MEDALHATEMA TINYINT UNSIGNED ZEROFILL NULL,
  PRIMARY KEY(USU_ID),
  INDEX FK_SEX_USU(USU_SEX_ID),
  INDEX FK_CAT_USU(USU_CAT_ID),
  INDEX FK_PEN_USU(USU_PEN_ID),
  INDEX FK_RAN_USU(USU_RAN_ID),
  FOREIGN KEY(USU_SEX_ID)
    REFERENCES TB_SEXO(SEX_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(USU_CAT_ID)
    REFERENCES TB_CATEGORIA(CAT_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(USU_PEN_ID)
    REFERENCES TB_PENALIDADE(PEN_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(USU_RAN_ID)
    REFERENCES TB_RANK(RAN_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

CREATE TABLE TB_COMENTARIO_POSI (
  COM_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  COM_USU_ID INTEGER UNSIGNED NOT NULL,
  COM_TEXTO TEXT NULL,
  PRIMARY KEY(COM_ID),
  INDEX FK_USU_COM(COM_USU_ID),
  FOREIGN KEY(COM_USU_ID)
    REFERENCES TB_USUARIO(USU_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

CREATE TABLE TB_DEF_TEMA (
  DTE_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  DTE_TEM_ID INTEGER UNSIGNED NOT NULL,
  DTE_CHA_ID INTEGER UNSIGNED NOT NULL,
  DTE_USU_ID INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(DTE_ID),
  INDEX FK_TEM_DTE(DTE_TEM_ID),
  INDEX FK_CHA_DTE(DTE_CHA_ID),
  INDEX FK_USU_DTE(DTE_USU_ID),
  FOREIGN KEY(DTE_TEM_ID)
    REFERENCES TB_TEMA(TEM_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(DTE_CHA_ID)
    REFERENCES TB_CHAT(CHA_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(DTE_USU_ID)
    REFERENCES TB_USUARIO(USU_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

CREATE TABLE TB_DEF_TAG (
  DTA_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  DTA_USU_ID INTEGER UNSIGNED NOT NULL,
  DTA_CHA_ID INTEGER UNSIGNED NOT NULL,
  DTA_TAG_ID INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(DTA_ID),
  INDEX FK_TAG_DTA(DTA_TAG_ID),
  INDEX FK_USU_DTA(DTA_USU_ID),
  INDEX FK_CHA_DTA(DTA_CHA_ID),
  FOREIGN KEY(DTA_TAG_ID)
    REFERENCES TB_TAG(TAG_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(DTA_USU_ID)
    REFERENCES TB_USUARIO(USU_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(DTA_CHA_ID)
    REFERENCES TB_CHAT(CHA_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

